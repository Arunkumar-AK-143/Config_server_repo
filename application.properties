@PostMapping("/book")
public ResponseEntity<Ticket> bookTicket(@RequestParam Long eventId, HttpServletRequest request) {
    String authHeader = request.getHeader("Authorization");
    if (authHeader == null || !authHeader.startsWith("Bearer ")) {
        return ResponseEntity.status(401).body(null);
    }

    String token = authHeader.substring(7); // Remove "Bearer "

    Long userId;
    try {
        userId = jwtService.extractUserId(token);
    } catch (Exception e) {
        return ResponseEntity.status(401).body(null);
    }

    if (userId == null) {
        return ResponseEntity.status(401).body(null); // ðŸ”´ This is the line causing the error you're seeing
    }

    Event event = eventService.getEventById(eventId);
    User user = userService.getUserById(userId);

    Ticket ticket = ticketService.bookTicket(event, user);
    return ResponseEntity.ok(ticket);
}